#source("ML10_Svd_UsageExample_ucla_stat.r")
library(MASS)

a <- matrix(c(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1), 9, 4)

a.svd <- svd(a,nu=9,nv=4)
u <- a.svd$u
v <- a.svd$v
d <- diag(a.svd$d)
dim(u)
dim(d)
dim(v)
a.computed <- u %*% d %*% t(v) 

a.svd$d
## [1] 3.46e+00 1.73e+00 1.73e+00 1.92e-16
ds <- diag(1/a.svd$d[1:3])

us <- as.matrix(u[, 1:3])
vs <- as.matrix(v[, 1:3])

(a.ginv <- vs %*% ds %*% t(us))
##         [,1]    [,2]    [,3]    [,4]    [,5]    [,6]    [,7]    [,8]
## [1,]  0.0833  0.0833  0.0833  0.0833  0.0833  0.0833  0.0833  0.0833
## [2,]  0.2500  0.2500  0.2500 -0.0833 -0.0833 -0.0833 -0.0833 -0.0833
## [3,] -0.0833 -0.0833 -0.0833  0.2500  0.2500  0.2500 -0.0833 -0.0833
## [4,] -0.0833 -0.0833 -0.0833 -0.0833 -0.0833 -0.0833  0.2500  0.2500
##         [,9]
## [1,]  0.0833
## [2,] -0.0833
## [3,] -0.0833
## [4,]  0.2500
# using the function ginv defined in MASS
ginv(a)
##         [,1]    [,2]    [,3]    [,4]    [,5]    [,6]    [,7]    [,8]
## [1,]  0.0833  0.0833  0.0833  0.0833  0.0833  0.0833  0.0833  0.0833
## [2,]  0.2500  0.2500  0.2500 -0.0833 -0.0833 -0.0833 -0.0833 -0.0833
## [3,] -0.0833 -0.0833 -0.0833  0.2500  0.2500  0.2500 -0.0833 -0.0833
## [4,] -0.0833 -0.0833 -0.0833 -0.0833 -0.0833 -0.0833  0.2500  0.2500
##         [,9]
## [1,]  0.0833
## [2,] -0.0833
## [3,] -0.0833
## [4,]  0.2500